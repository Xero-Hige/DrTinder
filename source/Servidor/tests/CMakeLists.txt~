cmake_minimum_required(VERSION 2.8)
ENABLE_TESTING()

INCLUDE_DIRECTORIES(../../libs/mongoose)
INCLUDE_DIRECTORIES(../Handlers)
INCLUDE_DIRECTORIES(../Parsers)
INCLUDE_DIRECTORIES(../../libs/jsoncpp/dist/json)
INCLUDE_DIRECTORIES(../../libs/rocksdb/include/rocksdb/)
INCLUDE_DIRECTORIES(../../libs/rocksdb/include/rocksdb/utilities/)
INCLUDE_DIRECTORIES(../../libs/swift/Swiften)
INCLUDE_DIRECTORIES(../../libs/googletest)
INCLUDE_DIRECTORIES(/usr/lib/x86_64-linux-gnu/)
LINK_DIRECTORIES(/usr/local/lib/ /usr/lib /usr/lib/x86_64-linux-gnu/ ../)

SET(SERVER_LIBS rt Swiften libidn.so libresolv.so boost_system boost_date_time expat pthread rocksdb z bz2 snappy curl restclient-cpp xml2 gtest gcov)

SET (COMMON_FLAGS "-g -W -Wall -Wno-unused-function")
SET (CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${COMMON_FLAGS}")

ADD_DEFINITIONS(-std=c++11)

ADD_EXECUTABLE (Test main.cpp)
target_compile_options(Test PRIVATE -coverage)
ADD_DEFINITIONS(-DMG_ENABLE_SSL)
ADD_DEFINITIONS(-DMG_ENABLE_THREADS)
TARGET_LINK_LIBRARIES(Test ${SSL_LIBS})
TARGET_LINK_LIBRARIES(Test ${TEST_LIBS} libserver)


